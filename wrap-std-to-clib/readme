use c handle  instead of c++ object, and use return code instead of exception
